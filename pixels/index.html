<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Send Dynotic Email</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f3f4f6; padding: 20px; }
    input, select, textarea, button { width: 100%; padding: 8px; margin-bottom: 12px; box-sizing: border-box; }
    button { background: #2563eb; color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; }
    #preview { background: #fff; padding: 12px; max-width: 600px; margin-top: 20px; border: 1px solid #ddd; }
    #preview img { width: 100%; height: auto; display: block; margin-bottom: 12px; }
  </style>
</head>
<body>

  <h2>Send Dynotic Email</h2>

  <!-- Form -->
  <label>Recipient Email:</label>
  <input type="email" id="to_email" placeholder="example@email.com">

  <label>Artist Name:</label>
  <input type="text" id="artist_name" placeholder="Artist Name">

  <label>Track Title:</label>
  <input type="text" id="track_title" placeholder="Track Title">

  <label>Status:</label>
  <select id="status" onchange="updatePreview()">
    <option value="Approved">Approved</option>
    <option value="Rejected">Rejected</option>
  </select>

  <label>Reason (if Rejected):</label>
  <textarea id="reason_input" placeholder="Type rejection reason here..." rows="3"></textarea>

  <button onclick="sendEmail()">Send Email</button>

  <!-- Preview -->
  <div id="preview"></div>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    emailjs.init("PdAawBLVBYxfLmoZj"); // Your PUBLIC KEY

    function updatePreview() {
      const artist_name = document.getElementById("artist_name").value || 'Artist Name';
      const track_title = document.getElementById("track_title").value || 'Track Title';
      const status = document.getElementById("status").value;
      const reason = document.getElementById("reason_input").value;

      const isApproved = status === 'Approved';
      const opening_text = isApproved 
        ? 'Congratulations! Your release has been approved.'
        : 'After review by our team, the following release cannot be processed.';
      const status_color = isApproved ? '#15803d' : '#b91c1c';
      const reason_message = isApproved 
        ? 'Your release is now available on all platforms.<br><br>'
        : `<b>Reason for Rejection:</b> ${reason}<br><br>`;

      document.getElementById("preview").innerHTML = `
        <img src="https://i.imgur.com/eg7hX2C.jpeg" alt="Banner">
        <div>Hello <b>${artist_name}</b>,</div><br>
        <div>${opening_text}<br><br></div>
        <div><b>Track Title:</b> ${track_title}<br>
        <b>Artist:</b> ${artist_name}<br>
        <b>Status:</b> <span style="color:${status_color}; font-weight:700;">${status}</span><br><br></div>
        <div>${reason_message}</div>
        <div style="font-size:11px; color:#6b7280; text-align:center; margin-top:20px;">
          Dynotic Collective<br>
          Â© 2025 Dynotic Collective. All rights reserved.
        </div>
      `;
    }

    function sendEmail() {
      const to_email = document.getElementById("to_email").value;
      const artist_name = document.getElementById("artist_name").value;
      const track_title = document.getElementById("track_title").value;
      const status = document.getElementById("status").value;
      const reason = document.getElementById("reason_input").value;
      const isApproved = status === 'Approved';
      const opening_text = isApproved 
        ? 'Congratulations! Your release has been approved.'
        : 'After review by our team, the following release cannot be processed.';
      const reason_message = isApproved ? 'Your release is now available on all platforms.' : reason;

      if(!to_email || !artist_name || !track_title) {
        alert("Please fill in Recipient Email, Artist Name, and Track Title.");
        return;
      }

      emailjs.send("service_xotxirq", "template_3xk1kok", {
        to_email: to_email,
        artist_name: artist_name,
        track_title: track_title,
        status: status,
        opening_text: opening_text,
        reason_message: reason_message,
        status_color: isApproved ? '#15803d' : '#b91c1c'
      }).then(
        () => alert("Email sent successfully!"),
        err => alert("Error: " + err.text)
      );
    }

    // Init preview
    updatePreview();
  </script>

</body>
</html>
